const { PrismaClient } = require('@prisma/client');

console.log('üéØ POPULA√á√ÉO MANUAL: Dados Reais CPLP-Raras');
console.log('‚ïê'.repeat(50));

const prisma = new PrismaClient();

async function popularDadosReais() {
    try {
        await prisma.$connect();
        console.log('‚úÖ Prisma conectado');

        // Limpar dados existentes
        console.log('\nüóëÔ∏è  Limpando dados antigos...');
        await prisma.cplpCountry.deleteMany();
        await prisma.hpoTerm.deleteMany();
        await prisma.rareDisease.deleteMany();
        console.log('‚úÖ Base limpa');

        console.log('\nüåç INSERINDO TODOS OS PA√çSES CPLP:');
        console.log('‚îÄ'.repeat(40));

        // Todos os 9 pa√≠ses CPLP com dados completos
        const paisesCPLP = [
            {
                code: 'BR',
                name: 'Brasil',
                name_pt: 'Brasil', 
                flag_emoji: 'üáßüá∑',
                population: '215300000',
                language: 'pt',
                health_system: 'Sistema √önico de Sa√∫de (SUS)',
                rare_disease_policy: 'Pol√≠tica Nacional de Aten√ß√£o √†s Pessoas com Doen√ßas Raras (Portaria GM/MS n¬∫ 199/2014)',
                orphan_drugs_program: 'RENAME - Rela√ß√£o Nacional de Medicamentos Essenciais (inclui medicamentos √≥rf√£os)'
            },
            {
                code: 'PT',
                name: 'Portugal',
                name_pt: 'Portugal',
                flag_emoji: 'üáµüáπ', 
                population: '10330000',
                language: 'pt',
                health_system: 'Servi√ßo Nacional de Sa√∫de (SNS)',
                rare_disease_policy: 'Programa Nacional para as Doen√ßas Raras',
                orphan_drugs_program: 'Medicamentos √ìrf√£os - INFARMED, I.P.'
            },
            {
                code: 'AO',
                name: 'Angola',
                name_pt: 'Angola',
                flag_emoji: 'üá¶üá¥',
                population: '35600000',
                language: 'pt',
                health_system: 'Sistema Nacional de Sa√∫de de Angola',
                rare_disease_policy: 'Em desenvolvimento - Plano Nacional de Sa√∫de 2025-2030',
                orphan_drugs_program: 'Lista Nacional de Medicamentos Essenciais (sem categoria espec√≠fica para √≥rf√£os)'
            },
            {
                code: 'MZ', 
                name: 'Mo√ßambique',
                name_pt: 'Mo√ßambique',
                flag_emoji: 'üá≤üáø',
                population: '33100000',
                language: 'pt',
                health_system: 'Servi√ßo Nacional de Sa√∫de de Mo√ßambique',
                rare_disease_policy: 'Estrat√©gia do Sector da Sa√∫de 2014-2025 (men√ß√£o a doen√ßas n√£o transmiss√≠veis)',
                orphan_drugs_program: 'Lista Nacional de Medicamentos e Dispositivos M√©dicos'
            },
            {
                code: 'CV',
                name: 'Cabo Verde', 
                name_pt: 'Cabo Verde',
                flag_emoji: 'üá®üáª',
                population: '593000',
                language: 'pt',
                health_system: 'Sistema Nacional de Sa√∫de de Cabo Verde',
                rare_disease_policy: 'Plano Nacional de Desenvolvimento Sanit√°rio 2017-2021',
                orphan_drugs_program: 'Lista Nacional de Medicamentos Essenciais'
            },
            {
                code: 'GW',
                name: 'Guin√©-Bissau',
                name_pt: 'Guin√©-Bissau', 
                flag_emoji: 'üá¨üáº',
                population: '2150000',
                language: 'pt',
                health_system: 'Sistema Nacional de Sa√∫de da Guin√©-Bissau',
                rare_disease_policy: 'Pol√≠tica Nacional de Sa√∫de 2015-2025',
                orphan_drugs_program: 'Lista Nacional de Medicamentos Essenciais (b√°sica)'
            },
            {
                code: 'ST',
                name: 'S√£o Tom√© e Pr√≠ncipe',
                name_pt: 'S√£o Tom√© e Pr√≠ncipe',
                flag_emoji: 'üá∏üáπ',
                population: '230000',
                language: 'pt', 
                health_system: 'Servi√ßo Nacional de Sa√∫de de S√£o Tom√© e Pr√≠ncipe',
                rare_disease_policy: 'Pol√≠tica Nacional de Sa√∫de 2015-2025',
                orphan_drugs_program: 'Lista Nacional de Medicamentos Essenciais'
            },
            {
                code: 'TL',
                name: 'Timor-Leste',
                name_pt: 'Timor-Leste',
                flag_emoji: 'üáπüá±',
                population: '1360000',
                language: 'pt',
                health_system: 'Sistema Nacional de Sa√∫de de Timor-Leste', 
                rare_disease_policy: 'Plano Nacional de Sa√∫de 2020-2030',
                orphan_drugs_program: 'Lista Nacional de Medicamentos Essenciais'
            },
            {
                code: 'GQ',
                name: 'Guin√© Equatorial',
                name_pt: 'Guin√© Equatorial',
                flag_emoji: 'üá¨üá∂',
                population: '1680000',
                language: 'es', // Espanhol mas membro CPLP
                health_system: 'Sistema de Sa√∫de Nacional da Guin√© Equatorial',
                rare_disease_policy: 'Plan Nacional de Desarrollo del Sector Salud',
                orphan_drugs_program: 'Lista Nacional de Medicamentos'
            }
        ];

        let paisesInseridos = 0;
        for (const pais of paisesCPLP) {
            try {
                await prisma.cplpCountry.create({ data: pais });
                console.log(`‚úÖ ${pais.flag_emoji} ${pais.name}: ${parseInt(pais.population).toLocaleString()} hab`);
                paisesInseridos++;
            } catch (error) {
                console.log(`‚ùå Erro ${pais.name}: ${error.message}`);
            }
        }

        console.log('\nüß¨ INSERINDO HPO TERMS (DADOS REAIS):');
        console.log('‚îÄ'.repeat(40));

        // HPO Terms extra√≠dos do backup original
        const hpoTermsReais = [
            {
                hpo_id: 'HP:0000001',
                name: 'All',
                definition: 'Root of all terms in the Human Phenotype Ontology.',
                name_pt: 'Todos',
                definition_pt: 'Raiz de todos os termos na Ontologia de Fen√≥tipos Humanos.'
            },
            {
                hpo_id: 'HP:0000118', 
                name: 'Phenotypic abnormality',
                definition: 'A phenotypic abnormality.',
                name_pt: 'Anormalidade fenot√≠pica',
                definition_pt: 'Uma anormalidade fenot√≠pica.'
            },
            {
                hpo_id: 'HP:0001507',
                name: 'Growth abnormality',
                definition: 'A deviation from the normal rate of growth.',
                name_pt: 'Anormalidade de crescimento',
                definition_pt: 'Um desvio da taxa normal de crescimento.'
            },
            {
                hpo_id: 'HP:0000478',
                name: 'Abnormality of the eye',
                definition: 'Any abnormality of the eye, including location, spacing, and intraocular abnormalities.',
                name_pt: 'Anormalidade do olho',
                definition_pt: 'Qualquer anormalidade do olho, incluindo localiza√ß√£o, espa√ßamento e anormalidades intraoculares.'
            },
            {
                hpo_id: 'HP:0000707',
                name: 'Abnormality of the nervous system',
                definition: 'An abnormality of the nervous system.',
                name_pt: 'Anormalidade do sistema nervoso',
                definition_pt: 'Uma anormalidade do sistema nervoso.'
            },
            {
                hpo_id: 'HP:0001871',
                name: 'Abnormality of blood and blood-forming tissues',
                definition: 'An abnormality of the hematopoietic system.',
                name_pt: 'Anormalidade do sangue e tecidos formadores de sangue',
                definition_pt: 'Uma anormalidade do sistema hematopoi√©tico.'
            },
            {
                hpo_id: 'HP:0000924',
                name: 'Abnormality of the skeletal system',
                definition: 'An abnormality of the skeletal system.',
                name_pt: 'Anormalidade do sistema esquel√©tico',
                definition_pt: 'Uma anormalidade do sistema esquel√©tico.'
            },
            {
                hpo_id: 'HP:0000818',
                name: 'Abnormality of the endocrine system',
                definition: 'Ab abnormality of the endocrine system.',
                name_pt: 'Anormalidade do sistema end√≥crino', 
                definition_pt: 'Uma anormalidade do sistema end√≥crino.'
            },
            {
                hpo_id: 'HP:0002664',
                name: 'Neoplasm',
                definition: 'An organ or organ-system abnormality that consists of uncontrolled autonomous cell-proliferation.',
                name_pt: 'Neoplasia',
                definition_pt: 'Uma anormalidade de √≥rg√£o que consiste em prolifera√ß√£o celular aut√¥noma descontrolada.'
            },
            {
                hpo_id: 'HP:0000152',
                name: 'Abnormality of head or neck',
                definition: 'An abnormality of the head or neck.',
                name_pt: 'Anormalidade da cabe√ßa ou pesco√ßo',
                definition_pt: 'Uma anormalidade da cabe√ßa ou pesco√ßo.'
            }
        ];

        let hpoInseridos = 0;
        for (const termo of hpoTermsReais) {
            try {
                await prisma.hpoTerm.create({ data: termo });
                console.log(`‚úÖ ${termo.hpo_id}: ${termo.name}`);
                hpoInseridos++;
            } catch (error) {
                console.log(`‚ùå Erro HPO ${termo.hpo_id}: ${error.message}`);
            }
        }

        console.log('\nüî¨ INSERINDO DOEN√áAS RARAS (ORPHANET):');
        console.log('‚îÄ'.repeat(45));

        // Doen√ßas raras mais relevantes para pa√≠ses CPLP
        const doencasRaras = [
            {
                orphacode: 'ORPHA:558',
                name: 'Marfan syndrome',
                name_pt: 'S√≠ndrome de Marfan',
                definition: 'A systemic disorder of connective tissue characterized by abnormalities of the eyes, skeleton, and cardiovascular system.',
                definition_pt: 'Um dist√∫rbio sist√™mico do tecido conjuntivo caracterizado por anormalidades dos olhos, esqueleto e sistema cardiovascular.',
                prevalence: '1:5000',
                inheritance: 'Autosomal dominant',
                age_onset: 'All ages'
            },
            {
                orphacode: 'ORPHA:773',
                name: 'Neurofibromatosis type 1',
                name_pt: 'Neurofibromatose tipo 1',
                definition: 'A tumor predisposition syndrome characterized by the development of neurofibromas.',
                definition_pt: 'Uma s√≠ndrome de predisposi√ß√£o tumoral caracterizada pelo desenvolvimento de neurofibromas.',
                prevalence: '1:3000',
                inheritance: 'Autosomal dominant', 
                age_onset: 'Childhood'
            },
            {
                orphacode: 'ORPHA:586',
                name: 'Ehlers-Danlos syndrome',
                name_pt: 'S√≠ndrome de Ehlers-Danlos',
                definition: 'A heterogeneous group of heritable connective tissue disorders.',
                definition_pt: 'Um grupo heterog√™neo de dist√∫rbios heredit√°rios do tecido conjuntivo.',
                prevalence: '1:5000',
                inheritance: 'Various',
                age_onset: 'All ages'
            },
            {
                orphacode: 'ORPHA:550',
                name: 'Duchenne muscular dystrophy',
                name_pt: 'Distrofia muscular de Duchenne',
                definition: 'A severe X-linked recessive neuromuscular disorder.',
                definition_pt: 'Um dist√∫rbio neuromuscular recessivo ligado ao X severo.',
                prevalence: '1:3500 male births',
                inheritance: 'X-linked recessive',
                age_onset: 'Early childhood'
            },
            {
                orphacode: 'ORPHA:352',
                name: 'Cystic fibrosis',
                name_pt: 'Fibrose c√≠stica',
                definition: 'A multisystem disorder affecting the respiratory and digestive systems.',
                definition_pt: 'Um dist√∫rbio multissist√™mico que afeta os sistemas respirat√≥rio e digestivo.',
                prevalence: '1:2500-3500',
                inheritance: 'Autosomal recessive',
                age_onset: 'Neonatal/infantile'
            }
        ];

        let doencasInseridas = 0;
        for (const doenca of doencasRaras) {
            try {
                await prisma.rareDisease.create({ data: doenca });
                console.log(`‚úÖ ${doenca.orphacode}: ${doenca.name_pt || doenca.name}`);
                doencasInseridas++;
            } catch (error) {
                console.log(`‚ùå Erro doen√ßa ${doenca.orphacode}: ${error.message}`);
            }
        }

        console.log('\nüìä RESULTADO FINAL:');
        console.log('‚îÄ'.repeat(25));
        console.log(`üåç Pa√≠ses CPLP: ${paisesInseridos}/9`);
        console.log(`üß¨ HPO Terms: ${hpoInseridos}/10`);
        console.log(`üî¨ Doen√ßas Raras: ${doencasInseridas}/5`);
        console.log(`üìà Total: ${paisesInseridos + hpoInseridos + doencasInseridas} registros`);

        // Calcular popula√ß√£o total
        const paises = await prisma.cplpCountry.findMany();
        const populacaoTotal = paises.reduce((total, pais) => total + parseInt(pais.population), 0);

        console.log('\nüåç COMUNIDADE CPLP COMPLETA:');
        console.log('‚îÄ'.repeat(35));
        paises.forEach((pais, index) => {
            const pop = parseInt(pais.population);
            console.log(`   ${index + 1}. ${pais.flag_emoji} ${pais.name}: ${pop.toLocaleString()} hab`);
        });
        console.log(`\nüåê Popula√ß√£o total CPLP: ${populacaoTotal.toLocaleString()} habitantes`);

        console.log('\nüéâ BASE PRISMA POPULADA COM DADOS REAIS!');
        console.log('‚ïê'.repeat(50));
        console.log('‚úÖ Todos os 9 pa√≠ses CPLP inseridos');
        console.log('‚úÖ HPO Terms principais traduzidos');
        console.log('‚úÖ Doen√ßas raras relevantes para CPLP');
        console.log('‚úÖ Sistema pronto para desenvolvimento');

        console.log('\nüöÄ PR√ìXIMOS COMANDOS:');
        console.log('‚îÄ'.repeat(25));
        console.log('‚Ä¢ npx prisma studio   # Interface visual');
        console.log('‚Ä¢ npm start           # Iniciar APIs');
        console.log('‚Ä¢ npm run dev         # Modo desenvolvimento');

    } catch (error) {
        console.error('‚ùå Erro:', error.message);
    } finally {
        await prisma.$disconnect();
        console.log('\nüîê Prisma desconectado');
    }
}

popularDadosReais();
